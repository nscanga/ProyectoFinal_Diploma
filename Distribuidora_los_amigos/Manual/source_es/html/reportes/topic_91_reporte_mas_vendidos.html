<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos M√°s Vendidos - Distribuidora Los Amigos</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>

    <div class="breadcrumb">
        <a href="../general/topic_20_main.html">Inicio</a>
        <span>‚Ä∫</span>
        <a href="#">Reportes</a>
        <span>‚Ä∫</span>
        <span>Productos M√°s Vendidos</span>
    </div>

    <h1>Productos M√°s Vendidos</h1>

    <section id="introduccion">
        <h2>Introducci√≥n</h2>
        <p>
            Este reporte muestra los productos con mayor cantidad de ventas en el per√≠odo seleccionado.
            Consolida la informaci√≥n de pedidos confirmados para ayudar a identificar tendencias de consumo.
        </p>
        <p>
            Es ideal para planificar compras, definir campa√±as comerciales o analizar la rentabilidad
            de cada referencia. Permite ajustar f√°cilmente el rango temporal y la cantidad de √≠tems a visualizar.
        </p>
    </section>

    <section id="acceso">
        <h2>C√≥mo Acceder</h2>
        <p>Para acceder a esta funcionalidad:</p>
        <ol>
            <li>Desde el men√∫ principal, ir a <strong>Reportes</strong>.</li>
            <li>Seleccionar <strong>M√°s Vendidos</strong>.</li>
            <li>Se abrir√° la ventana de <strong>Productos M√°s Vendidos</strong> con los filtros por defecto.</li>
        </ol>
    </section>

    <section id="campos">
        <h2>Descripci√≥n de Controles</h2>
        <p>A continuaci√≥n se describe cada control disponible en la pantalla:</p>

        <table>
            <thead>
                <tr>
                    <th>Control</th>
                    <th>Descripci√≥n</th>
                    <th>Tipo</th>
                    <th>Obligatorio</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Desde</strong> (dtpDesde)</td>
                    <td>Fecha inicial del rango a analizar. Se propone el √∫ltimo mes por defecto.</td>
                    <td>Selector de fecha</td>
                    <td>S√≠</td>
                </tr>
                <tr>
                    <td><strong>Hasta</strong> (dtpHasta)</td>
                    <td>Fecha final inclusive. Debe ser igual o posterior a la fecha inicial.</td>
                    <td>Selector de fecha</td>
                    <td>S√≠</td>
                </tr>
                <tr>
                    <td><strong>Filtrar</strong> (btnFiltrar)</td>
                    <td>Aplica el rango de fechas seleccionado y actualiza las m√©tricas y la grilla.</td>
                    <td>Bot√≥n</td>
                    <td>‚Äî</td>
                </tr>
                <tr>
                    <td><strong>Top Productos</strong> (txtTopProductos)</td>
                    <td>Cantidad de posiciones a mostrar en el ranking (por ejemplo, 10, 20, 50).</td>
                    <td>Campo num√©rico</td>
                    <td>S√≠</td>
                </tr>
                <tr>
                    <td><strong>Actualizar</strong> (btnActualizarTop)</td>
                    <td>Confirma el valor ingresado en <strong>Top Productos</strong> y recalcula el ranking.</td>
                    <td>Bot√≥n</td>
                    <td>‚Äî</td>
                </tr>
                <tr>
                    <td><strong>Exportar a Excel</strong> (btnExportarExcel)</td>
                    <td>Genera un archivo CSV con el ranking actual para compartir o analizar en otra herramienta.</td>
                    <td>Bot√≥n</td>
                    <td>‚Äî</td>
                </tr>
                <tr>
                    <td><strong>Indicadores</strong> (panelEstadisticas)</td>
                    <td>Muestra total vendido en pesos, unidades totales, cantidad de productos √∫nicos y per√≠odo seleccionado.</td>
                    <td>Etiquetas</td>
                    <td>‚Äî</td>
                </tr>
                <tr>
                    <td><strong>Grilla de resultados</strong> (sfDataGrid1)</td>
                    <td>Lista ordenada por cantidad vendida con posici√≥n, producto, categor√≠a, unidades, monto, precio promedio y veces vendido.</td>
                    <td>Tabla</td>
                    <td>S√≠</td>
                </tr>
            </tbody>
        </table>
    </section>

    <section id="procedimiento">
        <h2>Procedimiento</h2>

        <div class="step">
            <span class="step-number">1</span>
            <strong>Elegir per√≠odo</strong>
            <p>Seleccione fechas en <strong>Desde</strong> y <strong>Hasta</strong> y presione <strong>Filtrar</strong> para actualizar los datos.</p>
        </div>

        <div class="step">
            <span class="step-number">2</span>
            <strong>Ajustar el ranking</strong>
            <p>Defina cu√°ntos productos quiere ver escribiendo el valor en <strong>Top Productos</strong> y haga clic en <strong>Actualizar</strong>.</p>
        </div>

        <div class="step">
            <span class="step-number">3</span>
            <strong>Analizar resultados</strong>
            <p>Ordene o filtre la grilla por categor√≠a o monto para identificar oportunidades comerciales y patrones de demanda.</p>
        </div>

        <div class="step">
            <span class="step-number">4</span>
            <strong>Exportar ranking</strong>
            <p>Pulse <strong>Exportar a Excel</strong> para generar un CSV y compartirlo con compras, marketing o direcci√≥n.</p>
        </div>
    </section>

    <section id="validaciones">
        <h2>Validaciones del Sistema</h2>
        <p>El sistema realiza las siguientes validaciones:</p>
        <ul>
            <li>La fecha <strong>Desde</strong> debe ser menor o igual a la fecha <strong>Hasta</strong>; si no, se muestra un aviso.</li>
            <li>El valor de <strong>Top Productos</strong> debe ser un entero positivo mayor a cero.</li>
            <li>La exportaci√≥n a CSV se deshabilita cuando no hay informaci√≥n en la grilla.</li>
        </ul>
    </section>

    <section id="consejos">
        <h2>Consejos y Recomendaciones</h2>

        <div class="tip">
            Combine este reporte con el an√°lisis de stock para asegurar disponibilidad de los productos m√°s demandados.</div>

        <div class="tip">
            Guarde distintos per√≠odos (mensual, trimestral) para comparar tendencias y ajustar precios o promociones.</div>

        <div class="warning">
            <strong>‚ö†Ô∏è Advertencia:</strong> Si el per√≠odo seleccionado incluye fechas futuras sin ventas registradas, los totales pueden resultar en cero.</div>
    </section>

    <section id="errores">
        <h2>Errores Comunes y Soluciones</h2>

        <h3>Error: "La fecha desde debe ser menor a la fecha hasta"</h3>
        <div class="error">
            <strong>Causa:</strong> Se eligi√≥ un rango de fechas invertido.</div>
        <div class="success">
            <strong>‚úÖ Soluci√≥n:</strong> Ajuste las fechas asegurando que <strong>Desde</strong> sea anterior o igual a <strong>Hasta</strong> y vuelva a filtrar.</div>

        <h3>Error: "No hay datos para exportar"</h3>
        <div class="error">
            <strong>Causa:</strong> No existen pedidos confirmados en el per√≠odo actual o el top configurado es muy restrictivo.</div>
        <div class="success">
            <strong>‚úÖ Soluci√≥n:</strong> Ampl√≠e el rango de fechas o incremente el n√∫mero de productos y actualice el reporte antes de exportar.</div>
    </section>

    <section id="permisos">
        <h2>Permisos Necesarios</h2>
        <p>Para utilizar esta funcionalidad, el usuario debe tener el siguiente permiso:</p>
        <ul>
            <li><code>ReporteProductosMasVendidos</code> - Autoriza la consulta y exportaci√≥n del ranking de ventas.</li>
        </ul>

        <div class="warning">
            <strong>‚ö†Ô∏è Importante:</strong> Si no cuenta con el permiso requerido, contacte al administrador del sistema para solicitarlo.</div>
    </section>

    <section id="relacionados">
        <h2>Ver Tambi√©n</h2>
        <ul class="no-bullets">
            <li>üìÑ <a href="../pedidos/topic_82_mostrar_pedidos.html">Listado de pedidos</a></li>
            <li>üìÑ <a href="../productos/topic_52_mostrar_productos.html">Listado de productos</a></li>
        </ul>
    </section>

    <footer>
        <p>¬© 2024 Distribuidora Los Amigos - Sistema de Gesti√≥n</p>
        <p>Todos los derechos reservados</p>
    </footer>

</body>
</html>
