<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modificar Pedido - Distribuidora Los Amigos</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>

    <div class="breadcrumb">
        <a href="../general/topic_20_main.html">Inicio</a>
        <span>‚Ä∫</span>
        <a href="#">Gesti√≥n de Pedidos</a>
        <span>‚Ä∫</span>
        <span>Modificar Pedido</span>
    </div>

    <h1>Modificar Pedido</h1>

    <section id="introduccion">
        <h2>Introducci√≥n</h2>
        <p>
            Este formulario permite actualizar el estado de un pedido existente y consultar los datos principales
            asociados (cliente, fecha y cantidad de art√≠culos). Tambi√©n ofrece la opci√≥n de cancelar el pedido,
            restituyendo el stock reservado para cada producto.
        </p>
        <p>
            Util√≠celo cuando un pedido avance en el circuito log√≠stico (por ejemplo, pasa a <strong>En camino</strong>
            o <strong>Entregado</strong>) o cuando sea necesario anularlo antes de su despacho.
        </p>
    </section>

    <section id="acceso">
        <h2>C√≥mo Acceder</h2>
        <p>Para acceder a esta funcionalidad:</p>
        <ol>
            <li>Desde el men√∫ principal seleccione <strong>Pedidos ‚Üí Mostrar pedidos</strong>.</li>
            <li>Elija un pedido en la grilla y presione <strong>‚úèÔ∏è Modificar</strong>.</li>
            <li>Se abrir√° la ventana <strong>ModificarPedidoForm</strong> con los datos precargados.</li>
        </ol>
    </section>

    <section id="campos">
        <h2>Controles principales</h2>
        <table>
            <thead>
                <tr>
                    <th>Control</th>
                    <th>Descripci√≥n</th>
                    <th>Obligatorio</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Cantidad total de √≠tems</strong> (numericUpDown1)</td>
                    <td>Muestra la suma de unidades del pedido. Es informativo y se completa autom√°ticamente.</td>
                    <td>No</td>
                </tr>
                <tr>
                    <td><strong>Id Pedido</strong> (textBoxIdPedido)</td>
                    <td>Identificador √∫nico del pedido. Se muestra solo para referencia.</td>
                    <td>S√≠</td>
                </tr>
                <tr>
                    <td><strong>Cliente</strong> (comboBoxSeleccionCliente)</td>
                    <td>Cliente asociado al pedido. Se carga autom√°ticamente y se recomienda no modificarlo desde esta vista.</td>
                    <td>S√≠</td>
                </tr>
                <tr>
                    <td><strong>Fecha del pedido</strong> (dateTimePickerCrearPedido)</td>
                    <td>Fecha registrada originalmente. Solo lectura.</td>
                    <td>S√≠</td>
                </tr>
                <tr>
                    <td><strong>Estado</strong> (comboBoxEstadoPedido)</td>
                    <td>Listado de estados disponibles (Pendiente, En preparaci√≥n, En camino, Entregado, etc.).</td>
                    <td>S√≠</td>
                </tr>
                <tr>
                    <td><strong>Modificar pedido</strong></td>
                    <td>Bot√≥n que confirma el nuevo estado y, si corresponde, env√≠a la notificaci√≥n por email al cliente.</td>
                    <td>‚Äî</td>
                </tr>
                <tr>
                    <td><strong>Eliminar pedido</strong></td>
                    <td>Cancela el pedido completo, elimina los detalles y devuelve el stock comprometido.</td>
                    <td>‚Äî</td>
                </tr>
                <tr>
                    <td><strong>Guardar pedido</strong></td>
                    <td>Bot√≥n reservado para futuras ampliaciones. Actualmente no ejecuta acciones adicionales.</td>
                    <td>‚Äî</td>
                </tr>
            </tbody>
        </table>
    </section>

    <section id="procedimiento">
        <h2>Procedimiento</h2>

        <div class="step">
            <span class="step-number">1</span>
            <strong>Revise la informaci√≥n del pedido</strong>
            <p>Verifique el cliente, la fecha registrada y la cantidad total de art√≠culos antes de realizar cambios.</p>
        </div>

        <div class="step">
            <span class="step-number">2</span>
            <strong>Seleccione el nuevo estado</strong>
            <p>Elija el estado adecuado en el combo <strong>Estado</strong>. Solo los estados habilitados por el servicio se muestran.</p>
        </div>

        <div class="step">
            <span class="step-number">3</span>
            <strong>Confirme con ‚ÄúModificar pedido‚Äù</strong>
            <p>Presione el bot√≥n <strong>Modificar pedido</strong>. El sistema valida el cambio, actualiza el estado y, si el nuevo estado es <em>En camino</em>, env√≠a un correo al cliente (si tiene email v√°lido).</p>
        </div>

        <div class="step">
            <span class="step-number">4</span>
            <strong>Cancelar el pedido (opcional)</strong>
            <p>Si necesita anularlo, presione <strong>Eliminar pedido</strong>. El stock se restituye autom√°ticamente antes de eliminar el registro.</p>
        </div>

        <div class="step">
            <span class="step-number">5</span>
            <strong>Cierre el formulario</strong>
            <p>Al finalizar, cierre la ventana para regresar al listado. Los cambios se reflejar√°n al actualizar la grilla.</p>
        </div>
    </section>

    <section id="validaciones">
        <h2>Validaciones del Sistema</h2>
        <p>El sistema realiza las siguientes validaciones:</p>
        <ul>
            <li>Exige seleccionar un estado v√°lido antes de confirmar el cambio.</li>
            <li>Si se intenta elegir el mismo estado actual se informa con un mensaje y no se realizan cambios.</li>
            <li>Cuando el nuevo estado es <em>En camino</em> se intenta enviar una notificaci√≥n al email del cliente; si falta el email se muestra una advertencia.</li>
            <li>Al eliminar un pedido se recorren todos los detalles y se incrementa el stock de cada producto antes de remover el registro.</li>
        </ul>
    </section>

    <section id="consejos">
        <h2>Consejos y Recomendaciones</h2>

        <div class="tip">
            Confirme con el sector log√≠stico el estado real del pedido antes de actualizarlo para mantener informados a los clientes.
        </div>

        <div class="tip">
            Utilice la tecla <strong>F1</strong> para abrir la ayuda contextual en cualquier momento.
        </div>

        <div class="warning">
            <strong>‚ö†Ô∏è Advertencia:</strong> La eliminaci√≥n del pedido es definitiva. Solo util√≠cela cuando est√© seguro de que no debe mantenerse el registro.
        </div>
    </section>

    <section id="errores">
        <h2>Errores Comunes y Soluciones</h2>

        <h3>Error: "Seleccione un estado v√°lido."</h3>
        <div class="error">
            <strong>Causa:</strong> No se eligi√≥ ning√∫n estado en el combo antes de presionar <em>Modificar pedido</em>.
        </div>
        <div class="success">
            <strong>‚úÖ Soluci√≥n:</strong> Seleccione un estado de la lista y vuelva a intentar la operaci√≥n.
        </div>

        <h3>Mensaje: "El estado seleccionado es el mismo actual."</h3>
        <div class="error">
            <strong>Causa:</strong> El pedido ya se encontraba en el estado elegido, por lo que no hay cambios que guardar.
        </div>
        <div class="success">
            <strong>‚úÖ Soluci√≥n:</strong> Seleccione un estado diferente o cierre el formulario si no necesita modificarlo.
        </div>
    </section>

    <section id="permisos">
        <h2>Permisos Necesarios</h2>
        <p>Para utilizar esta funcionalidad, el usuario debe tener la siguiente patente:</p>
        <ul>
            <li><code>MOSTRAR_PEDIDOS</code> - Habilita la gesti√≥n completa de pedidos (listar, modificar estado y eliminar).</li>
        </ul>

        <div class="warning">
            <strong>‚ö†Ô∏è Importante:</strong> Si no cuenta con el permiso necesario, solic√≠telo al administrador del sistema.
        </div>
    </section>

    <section id="relacionados">
        <h2>Ver Tambi√©n</h2>
        <ul class="no-bullets">
            <li>üìÑ <a href="topic_80_crear_pedido.html">Crear pedido</a></li>
            <li>üìÑ <a href="topic_82_mostrar_pedidos.html">Ver pedidos</a></li>
            <li>üìÑ <a href="topic_83_detalle_pedido.html">Detalle del pedido</a></li>
        </ul>
    </section>

    <footer>
        <p>¬© 2024 Distribuidora Los Amigos - Sistema de Gesti√≥n</p>
        <p>Todos los derechos reservados</p>
    </footer>

</body>
</html>
