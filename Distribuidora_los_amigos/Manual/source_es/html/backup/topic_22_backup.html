<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Backup - Distribuidora Los Amigos</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>

    <div class="breadcrumb">
        <a href="../general/topic_20_main.html">Inicio</a>
        <span>‚Ä∫</span>
        <a href="#">Backup y Restore</a>
        <span>‚Ä∫</span>
        <span>Crear Backup</span>
    </div>

    <h1>Crear backup de las bases de datos</h1>

    <section id="introduccion">
        <h2>¬øPara qu√© sirve?</h2>
        <p>
            Desde esta pantalla pod√©s generar un respaldo completo de las tres bases de datos del sistema
            (<strong>DistribuidoraLosAmigos</strong>, <strong>Login</strong> y <strong>Bitacora</strong>).
            El proceso crea un archivo <code>.bak</code> por cada base y deja todo listo para guardarlo en un
            disco externo o repositorio seguro.
        </p>
        <p>
            El formulario ejecuta la l√≥gica <code>BackUpLogic.PerformBackup</code> a trav√©s del servicio
            <code>BackupService.ExecuteBackup</code>, por lo que cualquier error quedar√° registrado en la bit√°cora.
        </p>
    </section>

    <section id="requisitos">
        <h2>Requisitos previos</h2>
        <ul>
            <li>Contar con permisos sobre el men√∫ <strong>Backup y Restore ‚Üí Generar Backup</strong>.</li>
            <li>Ejecutar la aplicaci√≥n con un usuario de Windows que tenga escritura sobre la carpeta destino.</li>
            <li>Disponer de espacio libre suficiente para almacenar tres archivos <code>.bak</code>.</li>
            <li>Verificar que el usuario de SQL Server tenga permisos <code>BACKUP DATABASE</code>.</li>
        </ul>
    </section>

    <section id="acceso">
        <h2>C√≥mo acceder</h2>
        <ol>
            <li>En la pantalla principal, abr√≠ el men√∫ <strong>Backup y Restore</strong>.</li>
            <li>Seleccion√° la opci√≥n <strong>Generar Backup</strong>.</li>
            <li>Se abrir√° el formulario <strong>BackUpForm</strong> en una pesta√±a dentro del MDI.</li>
        </ol>
    </section>

    <section id="procedimiento">
        <h2>Procedimiento paso a paso</h2>
        <ol>
            <li>Hac√© clic en el bot√≥n <strong>Crear BackUp</strong>.</li>
            <li>Eleg√≠ la carpeta donde quer√©s guardar los archivos. Si existen rutas sugeridas en <code>App.config</code>
                (claves <strong>BackupPath1</strong>, <strong>BackupPath2</strong>, <strong>BackupPath3</strong>),
                el selector se posicionar√° autom√°ticamente en la primera disponible.</li>
            <li>Confirm√° la ubicaci√≥n cuando el sistema te lo solicite.</li>
            <li>Esper√° a que finalice el proceso. Durante la ejecuci√≥n el bot√≥n queda deshabilitado y se muestra
                el estado <em>‚ÄúCreando backup...‚Äù</em>.</li>
            <li>Al completarse, se mostrar√° un mensaje informando la ruta final y se registrar√° la operaci√≥n en la bit√°cora.</li>
        </ol>
        <div class="info">
            Si la carpeta no existe, el sistema la crea autom√°ticamente antes de comenzar a copiar los archivos resultantes.
        </div>
    </section>

    <section id="archivos">
        <h2>Archivos generados</h2>
        <p>La carpeta seleccionada contendr√° tres archivos con marca de tiempo:</p>
        <pre><code>[Carpeta seleccionada]/
‚îú‚îÄ DistribuidoraLosAmigos_YYYY-MM-DD_hh-mm-ss.bak
‚îú‚îÄ Login_YYYY-MM-DD_hh-mm-ss.bak
‚îî‚îÄ Bitacora_YYYY-MM-DD_hh-mm-ss.bak</code></pre>
        <p>
            Los nombres exactos de las bases se leen de las claves <code>Database1Name</code>, <code>Database2Name</code>
            y <code>Database3Name</code> configuradas en <code>App.config</code> del proyecto WinForms.
        </p>
    </section>

    <section id="mensajes">
        <h2>Mensajes y registros</h2>
        <ul>
            <li>√âxito: ‚Äú<em>Backup creado exitosamente en ‚Ä¶</em>‚Äù.</li>
            <li>Error de permisos: ‚Äú<em>No tiene permisos para acceder a la carpeta seleccionada‚Ä¶</em>‚Äù.</li>
            <li>Errores t√©cnicos: se muestran en un cuadro de di√°logo y se registran con detalle en la bit√°cora.</li>
        </ul>
    </section>

    <section id="problemas">
        <h2>Soluci√≥n de problemas</h2>
        <table>
            <thead>
                <tr>
                    <th>Mensaje</th>
                    <th>Causa probable</th>
                    <th>C√≥mo resolver</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>‚ÄúDebe seleccionar una ruta v√°lida para el backup.‚Äù</td>
                    <td>No se eligi√≥ ninguna carpeta o la ruta qued√≥ vac√≠a.</td>
                    <td>Seleccion√° una carpeta local accesible y volv√© a ejecutar.</td>
                </tr>
                <tr>
                    <td>‚ÄúNo tiene permisos para acceder a la carpeta seleccionada.‚Äù</td>
                    <td>El usuario de Windows no puede escribir en el directorio.</td>
                    <td>Eleg√≠ otra ubicaci√≥n o ejecut√° la aplicaci√≥n con privilegios elevados.</td>
                </tr>
                <tr>
                    <td>Errores SQL (por ejemplo, <code>BACKUP DATABASE permission denied</code>).</td>
                    <td>El usuario de SQL Server no tiene permisos suficientes.</td>
                    <td>Solicit√° al DBA que otorgue permisos <code>BACKUP DATABASE</code> y <code>ALTER</code> sobre las bases.</td>
                </tr>
                <tr>
                    <td>‚ÄúError al ejecutar el backup: ‚Ä¶‚Äù</td>
                    <td>Problemas generales (rutas de configuraci√≥n faltantes, espacio insuficiente, etc.).</td>
                    <td>Revis√° las claves <strong>MiConexion</strong>, <strong>MiConexion2</strong> y <strong>LogDatabase</strong> y
                        verific√° el log para m√°s detalle.</td>
                </tr>
            </tbody>
        </table>
    </section>

    <section id="buenas-practicas">
        <h2>Buenas pr√°cticas recomendadas</h2>
        <ul>
            <li>Guardar los archivos generados en al menos dos ubicaciones (local y externa).</li>
            <li>Mantener un hist√≥rico diario de 7 d√≠as y un backup mensual durante un a√±o.</li>
            <li>Probar peri√≥dicamente la restauraci√≥n en un entorno de prueba.</li>
            <li>Etiquetar los respaldos importantes (cierre mensual, inventarios, etc.).</li>
        </ul>
    </section>

    <section id="relacionados">
        <h2>Ver tambi√©n</h2>
        <ul class="no-bullets">
            <li>üìÑ <a href="topic_30_restore.html">Restaurar bases de datos desde backup</a></li>
            <li>üìÑ <a href="topic_25_bitacora.html">Bit√°cora del sistema</a></li>
        </ul>
    </section>

    <footer>
        <p>¬© 2024 Distribuidora Los Amigos - Sistema de Gesti√≥n</p>
        <p>Documentaci√≥n de ayuda contextual (F1)</p>
    </footer>

</body>
</html>
