# ?? Guía Visual: HTML Help Workshop

## ?? Instalación

### **Paso 1: Descargar HTML Help Workshop**

1. Ir a: https://www.microsoft.com/en-us/download/details.aspx?id=21138
2. Click en **Download**
3. Ejecutar el archivo descargado: `htmlhelp.exe`
4. Seguir el asistente de instalación
5. Ruta típica de instalación: `C:\Program Files (x86)\HTML Help Workshop\`

---

## ?? Abrir un Proyecto Existente

### **Método 1: Desde Windows Explorer**

```
1. Navegar a: C:\DistribuidoraLosAmigos\Manual\source_es\
2. Doble click en: help_es.hhp
3. Se abrirá automáticamente en HTML Help Workshop
```

### **Método 2: Desde HTML Help Workshop**

```
1. Ejecutar: C:\Program Files (x86)\HTML Help Workshop\hhw.exe
2. Menu: File ? Open
3. Navegar a: C:\DistribuidoraLosAmigos\Manual\source_es\help_es.hhp
4. Click en "Abrir"
```

---

## ?? Interfaz de HTML Help Workshop

```
???????????????????????????????????????????????????????????
? File  Edit  View  Project  Test  Help                   ?
???????????????????????????????????????????????????????????
?                                                          ?
?  [Project] [Contents] [Index]  ? Pestañas              ?
?                                                          ?
?  Project Files:                                         ?
?  ?? ?? html\general\topic_20_main.html                  ?
?  ?? ?? html\login\topic_31_login.html                   ?
?  ?? ?? html\clientes\topic_40_crear_cliente.html       ?
?  ?? ... (más archivos)                                  ?
?                                                          ?
?  [Add/Remove]  [Options]  [Save All]  [Compile]        ?
?                                                          ?
???????????????????????????????????????????????????????????
```

### **Elementos de la Interfaz:**

1. **Pestaña Project:** Muestra todos los archivos HTML incluidos
2. **Pestaña Contents:** Editor de tabla de contenidos (TOC)
3. **Pestaña Index:** Editor de índice de búsqueda
4. **Botón Compile:** Compila el proyecto a CHM
5. **Botón Save All:** Guarda todos los cambios

---

## ?? Configurar el Proyecto

### **Abrir Opciones del Proyecto**

```
Menu: Project ? Options
O presionar: Alt + P, luego O
```

### **Pestaña "General"**

```
???????????????????????????????????????????
? General | Files | Compiler | ...        ?
???????????????????????????????????????????
?                                          ?
? Title:                                   ?
? [Sistema Distribuidora Los Amigos]      ?
?                                          ?
? Default file:                            ?
? [html\general\topic_20_main.html]       ?
?                                          ?
? Language:                                ?
? [0x40a Spanish (Spain) ?]              ?
?                                          ?
? Default window:                          ?
? [main]                                   ?
?                                          ?
???????????????????????????????????????????
```

**Configuración Recomendada:**
- **Title:** Sistema Distribuidora Los Amigos - Manual de Usuario
- **Default file:** html\general\topic_20_main.html
- **Language:** 0x40a Spanish (Spain) para español
- **Default window:** main

### **Pestaña "Compiler"**

```
???????????????????????????????????????????
? General | Files | Compiler | ...        ?
???????????????????????????????????????????
?                                          ?
? Compiled file:                           ?
? [..\help_es.chm]                        ?
?                                          ?
? ? Full-text search                      ?
?                                          ?
? Contents file:                           ?
? [help_es.hhc]                           ?
?                                          ?
? Index file:                              ?
? [help_es.hhk]                           ?
?                                          ?
???????????????????????????????????????????
```

**Configuración Recomendada:**
- **Compiled file:** ..\help_es.chm
- **Full-text search:** ? Habilitado
- **Contents file:** help_es.hhc
- **Index file:** help_es.hhk

---

## ?? Agregar Archivos HTML

### **Método 1: Individual**

```
1. Click en pestaña "Project"
2. Click en botón "Add/Remove"
3. Click en "Add..."
4. Navegar a la carpeta html\
5. Seleccionar archivo HTML
6. Click en "Abrir"
7. Repetir para cada archivo
```

### **Método 2: Ya están agregados en el .hhp**

Si usaste los archivos proporcionados, todos los archivos ya están en la lista.

---

## ?? Editar Tabla de Contenidos (TOC)

### **Abrir el Editor de TOC**

```
1. Click en pestaña "Contents"
2. Se mostrará la estructura de árbol
```

### **Estructura de la TOC:**

```
?? Sistema Distribuidora Los Amigos
?? ?? Inicio
?? ?? Login y Seguridad
?  ?? ?? Iniciar Sesión
?  ?? ?? Recuperar Contraseña
?  ?? ?? Cambiar Contraseña
?? ?? Gestión de Usuarios
?  ?? ?? Crear Usuario
?  ?? ?? Modificar Usuario
?  ?? ?? Mostrar Usuarios
?? ... (más secciones)
```

### **Agregar un Nuevo Tema (Heading)**

```
1. Click derecho en el elemento padre
2. Seleccionar "Insert a heading"
3. En la ventana:
   - Entry title: [Nombre del tema]
   - Click en "Add/Edit..."
   - Seleccionar archivo HTML
   - Click OK
```

### **Agregar una Nueva Página**

```
1. Click derecho en el elemento padre
2. Seleccionar "Insert a page"
3. Completar:
   - Entry title: [Nombre de la página]
   - File/URL: [Seleccionar archivo HTML]
4. Click OK
```

**Nota:** La TOC ya está completa en el archivo help_es.hhc proporcionado.

---

## ?? Editar Índice de Búsqueda

### **Abrir el Editor de Índice**

```
1. Click en pestaña "Index"
2. Se mostrará la lista de términos indexados
```

### **Agregar un Nuevo Término**

```
1. Click en botón "Insert a keyword"
2. Completar:
   - Keyword: [Término de búsqueda]
   - File/URL: [Seleccionar HTML asociado]
3. Click OK
```

### **Ejemplo de Términos:**

```
Backup ? html\backup\topic_22_backup.html
Cliente ? html\clientes\topic_40_crear_cliente.html
Login ? html\login\topic_31_login.html
Usuario ? html\usuarios\topic_23_crear_usuario.html
```

**Nota:** El índice ya está completo en el archivo help_es.hhk proporcionado.

---

## ?? Compilar el CHM

### **Método 1: Botón Compile**

```
1. Guardar todos los cambios (Ctrl + Shift + S)
2. Click en botón "Compile" (icono de martillo)
   O presionar F9
3. Esperar a que termine la compilación
4. Verificar en la ventana de log que no haya errores
```

### **Ventana de Compilación:**

```
???????????????????????????????????????????????
? Microsoft HTML Help Compiler               ?
???????????????????????????????????????????????
?                                             ?
? Compiling c:\...\help_es.hhp                ?
?                                             ?
? Compile Progress:                           ?
? ????????????????????????????  85%          ?
?                                             ?
? Log:                                        ?
? Created help_es.chm, 45,238 bytes          ?
? Compression decreased file by 12,456 bytes  ?
? Compiled successfully                       ?
?                                             ?
?                          [View File] [OK]   ?
???????????????????????????????????????????????
```

### **Mensajes de Compilación:**

- ? **"Compiled successfully"** - Compilación exitosa
- ?? **"Warning: ..."** - Advertencias (generalmente no críticas)
- ? **"Error: ..."** - Errores que impiden la compilación

### **Errores Comunes:**

| Error | Causa | Solución |
|-------|-------|----------|
| "Cannot find file" | Archivo HTML no existe | Verificar que el archivo esté en la ruta correcta |
| "Parse error" | HTML mal formado | Validar sintaxis HTML |
| "Permission denied" | Archivo CHM en uso | Cerrar el archivo CHM si está abierto |

---

## ?? Probar el CHM Compilado

### **Método 1: Botón "View File"**

```
1. Después de compilar exitosamente
2. Click en "View File" en la ventana de compilación
3. Se abrirá el CHM en el visor de Windows
```

### **Método 2: Abrir Directamente**

```
1. Navegar a: C:\DistribuidoraLosAmigos\Manual\
2. Doble click en: help_es.chm
```

### **Método 3: Desde Línea de Comandos**

```batch
start C:\DistribuidoraLosAmigos\Manual\help_es.chm
```

### **Método 4: Con TopicID Específico**

```batch
hh.exe "ms-its:C:\DistribuidoraLosAmigos\Manual\help_es.chm::/html/login/topic_31_login.html"
```

---

## ?? Previsualizar durante el Desarrollo

### **Ver Archivo HTML Individual**

```
1. En la pestaña "Project"
2. Click derecho en un archivo HTML
3. Seleccionar "View file"
4. Se abrirá en Internet Explorer
```

### **Probar la Navegación**

```
1. Menu: Test ? HTML Help ActiveX Control Test
2. Seleccionar el archivo CHM compilado
3. Probar navegación, búsqueda, índice
```

---

## ?? Workflow Completo

```
???????????????????????????????????????????????
? 1. Crear/Editar archivos HTML               ?
?    ?? Usar template.html como base          ?
???????????????????????????????????????????????
             ?
             ?
???????????????????????????????????????????????
? 2. Abrir proyecto en HTML Help Workshop     ?
?    ?? Abrir help_es.hhp                     ?
???????????????????????????????????????????????
             ?
             ?
???????????????????????????????????????????????
? 3. Verificar archivos incluidos             ?
?    ?? Pestaña Project                       ?
???????????????????????????????????????????????
             ?
             ?
???????????????????????????????????????????????
? 4. Guardar todo (Ctrl + Shift + S)         ?
???????????????????????????????????????????????
             ?
             ?
???????????????????????????????????????????????
? 5. Compilar (F9)                            ?
???????????????????????????????????????????????
             ?
             ?
???????????????????????????????????????????????
? 6. Revisar log de compilación               ?
?    ?? Verificar que diga "Compiled          ?
?       successfully"                          ?
???????????????????????????????????????????????
             ?
             ?
???????????????????????????????????????????????
? 7. Probar el CHM                            ?
?    ?? View File o abrir directamente        ?
???????????????????????????????????????????????
             ?
             ?
???????????????????????????????????????????????
? 8. Si hay errores ? volver al paso 1       ?
?    Si está OK ? Distribuir el CHM           ?
???????????????????????????????????????????????
```

---

## ?? Consejos y Trucos

### **Atajos de Teclado Útiles**

| Tecla | Acción |
|-------|--------|
| `F9` | Compilar proyecto |
| `Ctrl + S` | Guardar archivo actual |
| `Ctrl + Shift + S` | Guardar todos los archivos |
| `Alt + F4` | Cerrar HTML Help Workshop |

### **Optimizar el Tamaño del CHM**

```
1. Project ? Options
2. Pestaña "Compiler"
3. ? Enable compression
4. Compilar nuevamente
```

### **Habilitar Búsqueda de Texto Completo**

```
1. Project ? Options
2. Pestaña "Compiler"
3. ? Full-text search
4. Compilar nuevamente
```

### **Cambiar el Idioma del CHM**

Para español:
```
Language: 0x40a Spanish (Spain)
```

Para inglés:
```
Language: 0x409 English (United States)
```

Para portugués:
```
Language: 0x416 Portuguese (Portugal)
```

---

## ?? Solución de Problemas

### **Problema: "Cannot create output file"**

**Solución:**
```
1. Cerrar el archivo CHM si está abierto
2. Verificar permisos de escritura en la carpeta
3. Ejecutar HTML Help Workshop como administrador
```

### **Problema: "File not found: [archivo].html"**

**Solución:**
```
1. Verificar que el archivo HTML existe
2. Verificar que la ruta es relativa (no absoluta)
3. Ejemplo correcto: html\login\topic_31_login.html
4. Ejemplo incorrecto: C:\Users\...\topic_31_login.html
```

### **Problema: "Parse error in HTML file"**

**Solución:**
```
1. Abrir el archivo HTML en un editor
2. Verificar que esté bien formado
3. Validar HTML en: https://validator.w3.org/
4. Corregir errores de sintaxis
```

### **Problema: El CHM se abre en blanco**

**Solución:**
```
1. Click derecho en el archivo .chm
2. Propiedades
3. En la parte inferior: "Desbloquear" ?
4. Aplicar ? Aceptar
5. Abrir nuevamente
```

---

## ?? Verificar la Calidad del CHM

### **Checklist Final:**

- [ ] El CHM se abre sin errores
- [ ] La tabla de contenidos se muestra correctamente
- [ ] El índice de búsqueda funciona
- [ ] La búsqueda de texto completo funciona
- [ ] Todos los links internos funcionan
- [ ] Las imágenes se cargan (si las hay)
- [ ] Los estilos CSS se aplican correctamente
- [ ] No hay páginas en blanco
- [ ] Los TopicIDs abren las páginas correctas
- [ ] La navegación breadcrumb funciona

---

## ?? ¡CHM Listo!

Una vez compilado y probado, el archivo CHM está listo para:

1. ? Copiar a `C:\DistribuidoraLosAmigos\Manual\`
2. ? Probar desde la aplicación (presionar F1)
3. ? Distribuir con la aplicación

---

**Fecha de Creación:** 2024
**Versión:** 1.0
**Para:** HTML Help Workshop 1.4 o superior
